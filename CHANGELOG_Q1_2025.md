# ITSeats Server - 2025년 1분기 변경사항 문서

## 📋 개요
이 문서는 ITSeats Server 프로젝트의 2025년 1분기(10월~12월) 동안 이루어진 주요 변경사항을 정리한 것입니다.

## 🚀 주요 기능 추가

### 1. 토스페이먼츠 결제 시스템 통합
**구현일**: 2025년 12월 23일  
**담당자**: chk-jk

#### 주요 변경사항
- **토스페이먼츠 API 연동**: 외부 결제 시스템과의 통합
- **결제 승인 API**: 토스페이먼츠 결제 승인 처리 로직 구현
- **결제 상태 관리**: PENDING, COMPLETED, CANCELED 상태 관리
- **에러 처리 강화**: 결제 실패 시 적절한 에러 메시지 제공

#### 관련 파일
- `PaymentController.java` - 결제 API 엔드포인트
- `PaymentService.java` - 결제 비즈니스 로직
- `TossPaymentConfirmRequest.java` - 토스페이먼츠 요청 DTO
- `PaymentErrorCode.java` - 결제 관련 에러 코드

### 2. 가맹점 회원가입 및 로그인 API 분리
**구현일**: 2025년 12월 17일  
**담당자**: Woochang Lee

#### 주요 변경사항
- **가맹점 전용 회원가입**: 일반 고객과 가맹점 회원의 가입 프로세스 분리
- **가맹점 로그인 API**: 가맹점 전용 인증 시스템 구현
- **권한 관리**: 가맹점과 고객의 역할 기반 접근 제어
- **JWT 토큰 기반 인증**: 보안 강화를 위한 토큰 기반 인증 시스템

#### 관련 파일
- `OwnerMemberController.java` - 가맹점 회원 관리 컨트롤러
- `OwnerMemberService.java` - 가맹점 회원 비즈니스 로직
- `OwnerDto.java` - 가맹점 회원 DTO
- `MemberType.java` - 회원 타입 구분 (CUSTOMER, OWNER)

### 3. 쿠폰 시스템 구현
**구현일**: 2025년 12월 17일  
**담당자**: jaehwannnnnn, seanjung0915

#### 주요 변경사항
- **내 쿠폰목록 조회 API**: 사용자가 보유한 쿠폰 목록 조회 기능
- **쿠폰 적용 로직**: 주문 시 쿠폰 할인 적용 시스템
- **쿠폰 정책 서비스**: 쿠폰 사용 가능 여부 검증 로직
- **결제 시 쿠폰 연동**: 결제 프로세스와 쿠폰 시스템 통합

#### 관련 파일
- `CouponController.java` - 쿠폰 관리 컨트롤러
- `CouponService.java` - 쿠폰 비즈니스 로직
- `CouponPolicyService.java` - 쿠폰 정책 검증 서비스
- `MemberCoupon.java` - 회원 쿠폰 엔티티
- `PaymentCoupon.java` - 결제 쿠폰 엔티티

### 4. JWT 인증 시스템 개선
**구현일**: 2025년 12월 17일  
**담당자**: Woochang Lee

#### 주요 변경사항
- **JWT 인증 필터 추가**: 모든 요청에 대한 JWT 토큰 검증
- **UserDetails null 처리**: 인증되지 않은 사용자 처리 로직 개선
- **토큰 재발급 기능**: 만료된 토큰의 자동 재발급 시스템
- **보안 강화**: CSRF 보호 및 CORS 설정 최적화

#### 관련 파일
- `JwtAuthenticationFilter.java` - JWT 인증 필터
- `SecurityConfig.java` - Spring Security 설정
- `AuthUseCase.java` - 인증 비즈니스 로직
- `JwtTokenIssuer.java` - JWT 토큰 발급 서비스

### 5. 대기 배달 주문 조회 API
**구현일**: 2025년 12월 17일  
**담당자**: sseen2

#### 주요 변경사항
- **대기 중인 배달 주문 조회**: 라이더가 수락 가능한 주문 목록 조회
- **주문 접수 화면 개선**: 가맹점의 주문 접수 프로세스 최적화
- **라이더 배정 로직**: 주문과 라이더 매칭 시스템

#### 관련 파일
- `RiderOrderService.java` - 라이더 주문 서비스
- `OwnerOrderController.java` - 가맹점 주문 관리 컨트롤러
- `OrderReceptionResponse.java` - 주문 접수 응답 DTO

## 🔧 기술적 개선사항

### 1. 코드 품질 개선
- **커스텀 예외 처리**: 표준화된 예외 처리 시스템 도입
- **테스트 코드 보강**: 각 기능별 단위 테스트 추가
- **코드 리팩토링**: 중복 코드 제거 및 가독성 향상

### 2. 성능 최적화
- **Redis 분산 락**: 동시성 제어를 위한 Redisson 도입
- **데이터베이스 쿼리 최적화**: N+1 문제 해결 및 인덱스 최적화
- **캐싱 전략**: 자주 조회되는 데이터의 캐싱 적용

### 3. 보안 강화
- **Spring Security 통합**: 표준 보안 프레임워크 적용
- **JWT 토큰 관리**: 안전한 토큰 발급 및 검증 시스템
- **입력값 검증**: 모든 API 요청에 대한 유효성 검사 강화

## 📊 통계

### 커밋 현황
- **총 커밋 수**: 20+ 건
- **주요 개발자**: 
  - Woochang Lee (8건)
  - chk-jk (5건)
  - jaehwannnnnn (4건)
  - sseen2 (3건)

### 변경된 파일 수
- **총 파일 수**: 80+ 개
- **주요 변경 영역**:
  - 결제 시스템: 15개 파일
  - 인증 시스템: 12개 파일
  - 쿠폰 시스템: 18개 파일
  - 주문 시스템: 20개 파일
  - 테스트 코드: 15개 파일

## 🐛 버그 수정

### 1. 컴파일 오류 수정
- **자료형 문제 해결**: 타입 불일치로 인한 컴파일 오류 수정
- **의존성 충돌 해결**: 라이브러리 버전 충돌 문제 해결

### 2. 로직 오류 수정
- **주문 조회 로직**: 라이더 관련 조인 삭제로 성능 개선
- **쿠폰 적용 로직**: 할인 계산 오류 수정
- **인증 필터**: UserDetails null 처리 개선

## 🔮 향후 계획

### 1. 단기 계획 (다음 분기)
- **실시간 알림 시스템**: WebSocket을 활용한 실시간 주문 알림
- **결제 시스템 확장**: 다양한 결제 수단 추가 지원
- **모바일 앱 API**: 모바일 앱 전용 API 개발

### 2. 중장기 계획
- **마이크로서비스 아키텍처**: 모놀리식에서 마이크로서비스로 전환
- **AI 기반 추천 시스템**: 사용자 맞춤형 메뉴 추천
- **데이터 분석 대시보드**: 비즈니스 인사이트 제공

## 📝 결론

2025년 1분기 동안 ITSeats Server는 다음과 같은 주요 성과를 달성했습니다:

1. **핵심 비즈니스 기능 완성**: 결제, 쿠폰, 주문 관리 시스템 구현
2. **보안 시스템 강화**: JWT 기반 인증 및 권한 관리 시스템 구축
3. **코드 품질 향상**: 테스트 커버리지 증가 및 코드 리팩토링
4. **성능 최적화**: 데이터베이스 쿼리 최적화 및 캐싱 전략 적용

이러한 개선사항을 통해 안정적이고 확장 가능한 배달 플랫폼의 기반을 마련했습니다.

---

**문서 작성일**: 2025년 12월 23일  
**작성자**: 개발팀  
**버전**: 1.0 
